<div class="card table-card">
  <div class="card-body">
    <div class="filter-grid">
      <div>
        <label class="form-label">Zone ID</label>
        <input
          class="form-control"
          [(ngModel)]="filters.zoneId"
          (ngModelChange)="onFiltersChanged()"
          placeholder="Zone ID">
      </div>
      <div>
        <label class="form-label">MOH ID</label>
        <input
          class="form-control"
          [(ngModel)]="filters.mohId"
          (ngModelChange)="onFiltersChanged()"
          placeholder="MOH ID">
      </div>
      <div>
        <label class="form-label">Ward ID</label>
        <input
          class="form-control"
          [(ngModel)]="filters.wardId"
          (ngModelChange)="onFiltersChanged()"
          placeholder="Ward ID">
      </div>
      <div>
        <label class="form-label">Licence Application ID</label>
        <input
          class="form-control"
          [(ngModel)]="filters.licenceApplicationId"
          (ngModelChange)="onFiltersChanged()"
          placeholder="Licence Application ID">
      </div>
      <div>
        <label class="form-label">Application Number</label>
        <input
          class="form-control"
          [(ngModel)]="filters.applicationNumber"
          (ngModelChange)="onFiltersChanged()"
          placeholder="Application Number">
      </div>
      <div>
        <label class="form-label">Status</label>
        <select
          class="form-select"
          [(ngModel)]="filters.status"
          (ngModelChange)="onFiltersChanged()">
          <option value="ALL">All</option>
          <option value="APPLIED">Applied</option>
          <option value="INSPECTED">Inspected</option>
          <option value="APPROVED">Approved</option>
          <option value="REJECTED">Rejected</option>
          <option value="ENTERED">Entered</option>
        </select>
      </div>
    </div>

    <div class="table-responsive">
      <table class="table table-bordered table-hover mb-0">
        <thead class="table-light">
          <tr>
            <th style="width: 60px;">Sl. No</th>
            <th style="width: 200px;">Application No</th>
            <th style="width: 200px;">Applicant Name</th>
            <th style="width: 200px;">Trade Name</th>
            <th style="width: 140px;">Submitted Date</th>
            <th style="width: 140px;">Status</th>
            <th style="width: 160px;">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="isLoadingApplications">
            <td colspan="7" class="text-center py-3">
              Loading applications...
            </td>
          </tr>

          <tr
            *ngFor="let app of applications; let i = index"
            class="clickable-row"
            (click)="openDetails(app.licenceApplicationID)">
            <td>{{ showingFrom + i }}</td>
            <td>{{ app.applicationNumber }}</td>
            <td>{{ app.applicantName }}</td>
            <td>{{ app.tradeName }}</td>
            <td>{{ app.applicationSubmitDate | date:'dd-MMM-yyyy' }}</td>
            <td>
              <span class="badge bg-info text-dark">
                {{ app.licenceApplicationStatusName }}
              </span>
            </td>
            <td>
              <button
                class="btn btn-outline-primary btn-sm"
                (click)="onGenerateLicence(app.applicationNumber, app.licenceApplicationID); $event.stopPropagation()"
              >
                Generate Licence
              </button>
            </td>
          </tr>

          <tr *ngIf="!isLoadingApplications && applications.length === 0">
            <td colspan="7" class="text-center text-muted">
              No applications found
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="d-flex justify-content-between align-items-center mt-3">
      <div class="text-muted small">
        Showing {{ showingFrom }} - {{ showingTo }} of {{ totalRecords }} records
      </div>
      <nav>
        <ul class="pagination pagination-sm mb-0">
          <li class="page-item" [class.disabled]="pageNumber === 1">
            <button class="page-link" (click)="changePage(pageNumber - 1)">
              <
            </button>
          </li>
          <li
            class="page-item"
            *ngFor="let p of pages"
            [class.active]="p === pageNumber"
          >
            <button class="page-link" (click)="changePage(p)">
              {{ p }}
            </button>
          </li>
          <li class="page-item" [class.disabled]="pageNumber === totalPages">
            <button class="page-link" (click)="changePage(pageNumber + 1)">
              >
            </button>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>
