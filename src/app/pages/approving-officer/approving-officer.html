<div class="dashboard-wrapper">
  <!-- ================= CONTENT ================= -->
  <div class="container dashboard-content">
    <!-- ALERTS -->
        <div class="alert alert-danger">
          ⚠ Application <strong>N252629121357051</strong> is overdue for inspection
        </div>

    <!-- FILTERS -->
    <div class="card filter-card mb-3">
      <div class="card-body">
        <div class="row g-2 align-items-end">
          <div class="col-md-3">
            <label class="form-label">Search</label>
            <input class="form-control" placeholder="Application Name" />
          </div>

          <div class="col-md-2">
            <label class="form-label">Status</label>
            <select class="form-select">
              <option>All</option>
              <option>Pending</option>
              <option>Inspection</option>
              <option>Forwarded</option>
            </select>
          </div>

          <div class="col-md-2">
            <label class="form-label">Trade Type</label>
            <select class="form-select" [(ngModel)]="selectedTradeType">
              <option [ngValue]="null">Select</option>
              <option *ngFor="let trade of tradeTypes" [ngValue]="trade">
                {{ trade.tradeTypeName }}
              </option>
            </select>
          </div>

          <div class="col-md-2">
            <label class="form-label">Zone</label>
            <select class="form-select">
              <option>All</option>
            </select>
          </div>

          <div class="col-md-2">
            <label class="form-label">Ward</label>
            <select class="form-select">
              <option>All</option>
              <option>Ward 32</option>
              <option>Ward 45</option>
            </select>
          </div>

          <div class="col-md-2">
            <button class="btn btn-secondary">Apply Filters</button>
          </div>
        </div>
      </div>
    </div>
    <!-- APPLICATION TABLE -->
    <div class="card table-card">
      <div class="card-body p-0">
        <table class="table table-bordered table-hover mb-0 fixed-table">
          <thead class="table-light">
            <tr>
              <th style="width: 60px;">Sl. No</th>
              <th style="width: 220px;">Application Name</th>
              <th style="width: 200px;">Application No</th>
              <th style="width: 140px;">Submitted Date</th>
              <th style="width: 240px;">Trade Name</th>
              <th style="width: 120px;">Status</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngIf="isLoading">
              <td colspan="5" class="text-center py-4">
                <div class="spinner-border text-primary" role="status">
                  <span class="visually-hidden">Loading...</span>
                </div>
                <div class="mt-2 text-muted">Loading applications...</div>
              </td>
            </tr>
            
            <ng-container *ngIf="!isLoading && approvedApplicationDetails.length > 0">
              <tr
                *ngFor="let app of approvedApplicationDetails; let i = index"
                class="clickable-row"
                (click)="onInspectionClick(app.licenceApplicationID)"
              >
                <td>{{ i + 1 }}</td>
                <td>{{ app.applicantName }}</td>
                <td>{{ app.applicationNumber }}</td>
                <td>{{ app.applicationSubmitDate | date:'dd-MMM-yyyy' }}</td>
                <td>
                  {{ app.tradeName }}
                </td>
                <td>
                  <span class="badge bg-info text-dark">
                    {{ app.licenceApplicationStatusName }}
                  </span>
                </td>
              </tr>
            </ng-container>

            <!-- No Data -->
            <tr *ngIf="!isLoading && approvedApplicationDetails.length === 0">
              <td colspan="6" class="text-center text-muted">
                No applications found
              </td>
            </tr>
          </tbody>
        </table>

        <ng-template #noData>
          <tr>
            <td colspan="5" class="text-center text-muted">
              No applications found
            </td>
          </tr>
        </ng-template>

      </div>
      <div class="d-flex justify-content-between align-items-center mt-3 px-2">
        <!-- Records info -->
        <div class="text-muted small">
          Showing {{ showingFrom }} – {{ showingTo }} of {{ totalRecords }} records
        </div>


        <!-- Pagination -->
        <nav>
          <ul class="pagination pagination-sm mb-0">

            <!-- Previous -->
            <li class="page-item" [class.disabled]="pageNumber === 1">
              <button class="page-link" (click)="changePage(pageNumber - 1)">
                ‹
              </button>
            </li>

            <!-- Page numbers -->
            <li
              class="page-item"
              *ngFor="let p of pages"
              [class.active]="p === pageNumber"
            >
              <button class="page-link" (click)="changePage(p)">
                {{ p }}
              </button>
            </li>

            <!-- Next -->
            <li class="page-item" [class.disabled]="pageNumber === totalPages">
              <button class="page-link" (click)="changePage(pageNumber + 1)">
                ›
              </button>
            </li>

          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>

