<div class="page-header">
  <div>
    <h2>Master Data & Compliance</h2>
    <p>Maintain trade categories, zones, rules, and fee structures</p>
  </div>
</div>

<!-- TRADE CATEGORIES -->
<div class="card">
  <h3>Trade Categories</h3>

  <div class="field-block">
      <div class="field-header">
        <label>Trade Type</label>
        <div class="action-buttons">
          <button class="icon-btn primary" (click)="openModal('TRADE_CATEGORY')" title="Add Trade Categories">
            <i class="bi bi-plus-lg"></i>
          </button>
          <button
            class="icon-btn warning"
            (click)="openModal('TRADE_CATEGORY', true)"
            title="Edit Trade Categories"
          >
            <i class="bi bi-pencil"></i>
          </button>
        </div>
      </div>

      <select
        class="form-select"
        [(ngModel)]="selectedtradeTypes"
      >
        <option [ngValue]="null">Select</option>
        <option *ngFor="let tradeType of tradeTypes" [ngValue]="tradeType.tradeTypeID">
          {{ tradeType.tradeTypeName }}
        </option>
      </select>
    </div>
  
</div>

<!-- JURISDICTION MASTER -->
<div class="card master-card">
  <div class="card-header">
    <h3>Trade Details Master</h3>
    <p class="sub-text">Manage MLA Constituencies and Wards</p>
  </div>

  <!-- TWO COLUMN GRID -->
  <div class="two-col-grid">

    <!-- MLA SECTION -->
    <div class="field-block">
      <div class="field-header">
        <label>MLA Constituency</label>
        <div class="action-buttons">
          <button class="icon-btn primary" (click)="openModal('MLA')" title="Add MLA">
            <i class="bi bi-plus-lg"></i>
          </button>
          <button
            class="icon-btn warning"
            [disabled]="!selectedMLAConstituency"
            (click)="openModal('MLA', true)"
            title="Edit MLA"
          >
            <i class="bi bi-pencil"></i>
          </button>
        </div>
      </div>

      <select
        class="form-select"
        [(ngModel)]="selectedMLAConstituency"
        (change)="onMLAConstituencyChange()"
      >
        <option [ngValue]="null">Select MLA Constituency</option>
        <option *ngFor="let mla of mlaConstituencies" [ngValue]="mla">
          {{ mla.mohName }}
        </option>
      </select>
    </div>

    <!-- WARD SECTION -->
    <div class="field-block">
      <div class="field-header">
        <label>Ward</label>
        <div class="action-buttons">
          <button
            class="icon-btn primary"
            [disabled]="!selectedMLAConstituency"
            (click)="openModal('WARD')"
            title="Add Ward"
          >
            <i class="bi bi-plus-lg"></i>
          </button>
          <button
            class="icon-btn warning"
            [disabled]="!selectedWard"
            (click)="openModal('WARD', true)"
            title="Edit Ward"
          >
            <i class="bi bi-pencil"></i>
          </button>
        </div>
      </div>

      <select class="form-select" [(ngModel)]="selectedWard">
        <option [ngValue]="null">Select Ward</option>
        <option *ngFor="let ward of wards" [ngValue]="ward">
          {{ ward.wardName }}
        </option>
      </select>
    </div>

  </div>
</div>

  <!-- Trade Classification -->
  <div class="card master-card">
    <div class="card-header">
      <h3>Trade Classification</h3>
      <p class="sub-text">Manage Major, Minor and Sub Trades</p>
    </div>
    <div class="card master-card">
      <div class="two-col-grid">

        <!-- Major Trade -->
        <div class="field-block">
          <div class="field-header">
            <label>Major Trade</label>
            <div class="action-buttons">
              <button class="icon-btn primary" (click)="openModal('MAJOR_TRADE')" title="Add Major Trade">
                <i class="bi bi-plus-lg"></i>
              </button>
              <button class="icon-btn warning" 
                (click)="openModal('MAJOR_TRADE', true)"
                title="Edit Major Trade">
                <i class="bi bi-pencil"></i>
              </button>
            </div>
          </div>

          <select class="form-select" [(ngModel)]="selectedMajor" (change)="onMajorChange()">
            <option [ngValue]="null">Minor Trade</option>
            <option *ngFor="let majorTrade of tradeMajors" [ngValue]="majorTrade">
              {{ majorTrade.tradeMajorName }}
            </option>
          </select>
        </div>

        <!-- MINOR TRADE -->
        <div class="field-block">
          <div class="field-header">
            <label>Minor Trade</label>
            <div class="action-buttons">
              <button
                class="icon-btn primary"
                [disabled]="!selectedMajor"
                (click)="openModal('MINOR_TRADE')"
                title="Add Minor Trade"
              >
                <i class="bi bi-plus-lg"></i>
              </button>
              <button
                class="icon-btn warning"
                [disabled]="!tradeMajors"
                (click)="openModal('MINOR_TRADE', true)"
                title="Edit Minor Trade"
              >
                <i class="bi bi-pencil"></i>
              </button>
            </div>
          </div>

          <select class="form-select" [(ngModel)]="tradeMinors">
            <option [ngValue]="null">Select Minor Trade</option>
            <option *ngFor="let minorTrade of tradeMinors" [ngValue]="minorTrade">
              {{ minorTrade.tradeMinorName }}
            </option>
          </select>
        </div>

        <!-- SUB TRADE -->
        <div class="field-block">
          <div class="field-header">
            <label>Sub Trade</label>
            <div class="action-buttons">
              <button
                class="icon-btn primary"
                [disabled]="!selectedMinor"
                (click)="openModal('SUB_TRADE')"
                title="Add Sub Trade"
              >
                <i class="bi bi-plus-lg"></i>
              </button>
              <button
                class="icon-btn warning"
                [disabled]="!selectedSub"
                (click)="openModal('SUB_TRADE', true)"
                title="Edit Sub Trade"
              >
                <i class="bi bi-pencil"></i>
              </button>
            </div>
          </div>

          <select class="form-select" [(ngModel)]="tradeSubs">
            <option [ngValue]="null">Select Minor Trade</option>
            <option *ngFor="let subTrade of tradeSubs" [ngValue]="subTrade">
              {{ subTrade.tradeSubName }}
            </option>
          </select>
        </div>

        <!-- Price -->
        <div class="field-block">
          <div class="field-header">
            <label>Price</label>
            <div class="action-buttons">
              <button
                class="icon-btn primary"
                title="Save Price"
                (click)="saveTradePrice()"
              >
                <i class="bi bi-check-lg"></i>
              </button>
            </div>
          </div>

          <input
            type="number"
            class="form-control"
            placeholder="Enter price (e.g. 500)"
            [(ngModel)]="tradePrice"
          />
        </div>
      </div>
    </div>
  </div>

  <!-- Jurisdiction of Health Officer (Zone) -->
  <div class="card">
    <h3>Jurisdiction of Health Officer (Zone)</h3>

    <div class="field-block">
        <div class="field-header">
          <label>Jurisdiction of Health Officer (Zone)</label>
          <div class="action-buttons">
            <button class="icon-btn primary" (click)="openModal('ZONE')" title="Add Health Officer">
              <i class="bi bi-plus-lg"></i>
            </button>
            <button
              class="icon-btn warning"
              (click)="openModal('ZONE', true)"
              title="Edit Health Officer"
            >
              <i class="bi bi-pencil"></i>
            </button>
          </div>
        </div>

        <select
          class="form-select"
          [(ngModel)]="selectedZone"
        >
          <option [ngValue]="null">Select</option>
          <option *ngFor="let zone of zones" [ngValue]="zone">
            {{ zone.zoneName }}
          </option>
        </select>
      </div>
    
  </div>

<!-- Zone Classification -->
<div class="card master-card">
  <div class="card-header">
    <h3>Zone Classification</h3>
    <p class="sub-text">Manage Zone Classification</p>
  </div>

  <!-- TWO COLUMN GRID -->
  <div class="two-col-grid">

    <!-- Zone Classification SECTION -->
    <div class="field-block">
      <div class="field-header">
        <label>Zone Classification</label>
        <div class="action-buttons">
          <button class="icon-btn primary" (click)="openModal('ZONE_CLASSIFICATION')" title="Add Zone Classification">
            <i class="bi bi-plus-lg"></i>
          </button>
          <button
            class="icon-btn warning"
            (click)="openModal('ZONE_CLASSIFICATION', true)"
            title="Edit Health Officer"
          >
            <i class="bi bi-pencil"></i>
          </button>
        </div>
      </div>

      <select
        class="form-select"
        [(ngModel)]="selectedZone"
      >
        <option [ngValue]="null">Select Zone Classification</option>
        <option *ngFor="let zoneClassification of zoneClassifications" [ngValue]="zoneClassification">
          {{ zoneClassification.zonalClassificationName }}
        </option>
      </select>
    </div>

    <!-- Price -->
        <div class="field-block">
          <div class="field-header">
            <label>License Fee Prescribed</label>
            <div class="action-buttons">
              <button
                class="icon-btn primary"
                title="Save Price"
                (click)="saveLicenseFeePrescribed()"
              >
                <i class="bi bi-check-lg"></i>
              </button>
            </div>
          </div>

          <input
            type="number"
            class="form-control"
            placeholder="Enter price (e.g. 500)"
            [(ngModel)]="licenseFeePrescribed"
          />
        </div>
  </div>
</div>

  <!-- MODAL -->
<div class="modal-backdrop" *ngIf="activeModal">
  <div class="modal-container">

    <h3>
      {{ isEditMode ? 'Edit' : 'Add' }}
      {{ activeModal.replace('_', ' ') }}
    </h3>

    <!-- MLA -->
    <form *ngIf="activeModal === 'MLA'" [formGroup]="mlaForm">
      <label>MLA Name</label>
      <input class="form-control" formControlName="mohName" />
    </form>

    <!-- Ward -->
    <form *ngIf="activeModal === 'WARD'" [formGroup]="wardForm">
      <label>Ward Name</label>
      <input class="form-control" formControlName="wardName" />
    </form>

    <!-- Major Trade -->
    <form *ngIf="activeModal === 'MAJOR_TRADE'" [formGroup]="majorTradeForm">
      <label>Major Trade Name</label>
      <input class="form-control" formControlName="tradeMajorName" />
    </form>

    <!-- Minor Trade -->
    <form *ngIf="activeModal === 'MINOR_TRADE'" [formGroup]="minorTradeForm">
      <label>Minor Trade Name</label>
      <input class="form-control" formControlName="tradeMinorName" />
    </form>

    <!-- Sub Trade -->
    <form *ngIf="activeModal === 'SUB_TRADE'" [formGroup]="subTradeForm">
      <label>Sub Trade Name</label>
      <input class="form-control" formControlName="tradeSubName" />
    </form>

    <!-- Zone -->
    <form *ngIf="activeModal === 'ZONE'" [formGroup]="zoneForm">
      <label>Zone Name</label>
      <input class="form-control" formControlName="zoneName" />
    </form>

    <!-- Zone Classification -->
    <form *ngIf="activeModal === 'ZONE_CLASSIFICATION'" [formGroup]="zoneClassificationForm">
      <label>Zone Classification Name</label>
      <input class="form-control" formControlName="zonalClassificationName" />
    </form>

    <!-- Trade Category Name -->
    <form *ngIf="activeModal === 'TRADE_CATEGORY'" [formGroup]="tradeCategoryForm">
      <label>Trade Category Name</label>
      <input class="form-control" formControlName="tradeCategoryName" />
    </form>

    <!-- Actions -->
    <div class="modal-actions">
      <button class="btn-secondary" (click)="activeModal = null">
        Cancel
      </button>
      <button type="button" class="btn-primary" (click)="saveModal()">
        {{ isEditMode ? 'Update' : 'Save' }}
      </button>
    </div>

  </div>
</div>
